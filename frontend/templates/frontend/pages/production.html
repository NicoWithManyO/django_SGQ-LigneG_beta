{% extends 'frontend/base/base.html' %}
{% load static %}

{% block title %}Test Layout & Blocks - SGQ Ligne G{% endblock %}

{% block extra_css %}
<!-- CSS modulaires -->
<link rel="stylesheet" href="{% static 'frontend/css/layout.css' %}">
<link rel="stylesheet" href="{% static 'frontend/css/blocks.css' %}">
<link rel="stylesheet" href="{% static 'frontend/css/forms.css' %}">

{% endblock %}

{% block extra_js %}
<script src="{% static 'frontend/js/blocks.js' %}"></script>
<script src="{% static 'frontend/js/fiche_poste.js' %}"></script>
{% endblock %}

{% block content %}
{% csrf_token %}
<div class="sgq-production-layout">
    <!-- Colonne Gauche - 1/4 -->
    <div class="sgq-column sgq-column-left">
        <!-- Block Fiche de Poste -->
        <div class="sgq-block" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">üìã</span>
                    Fiche de Poste
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <!-- Pass session data to component -->
                    <script>
                        window.currentOperator = {{ current_operator_json|safe }};
                        window.sessionData = {{ session_data|safe }};
                        console.log('Session data loaded:', window.sessionData);
                    </script>
                    {% include 'frontend/pages/includes/fiche_poste.html' %}
                </div>
            </div>
        </div>
        
        <!-- Block Ordre de Fabrication -->
        <div class="sgq-block" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">üìã</span>
                    Ordre de Fabrication
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <div>
                        <small>OF: 123456</small><br>
                        <small>Client: ACME Corp</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Colonne Centrale - 2/4 -->
    <div class="sgq-column sgq-column-center">
        <!-- Block Profil avec contenu tableau -->
        <div class="sgq-block sgq-block-no-padding" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">‚öôÔ∏è</span>
                    Profil : 80g/m¬≤ (Permissif)
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <table class="sgq-table">
                        <thead>
                            <tr>
                                <th>Param√®tre</th>
                                <th>Valeur</th>
                                <th>Nominal</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>√âpaisseur</td>
                                <td>3.2 mm</td>
                                <td style="color: #28a745;">6.5</td>
                            </tr>
                            <tr>
                                <td>Masse surfacique</td>
                                <td>72 g/m¬≤</td>
                                <td style="color: #28a745;">81</td>
                            </tr>
                            <tr>
                                <td>Vitesse tapis</td>
                                <td>17.40 m/h</td>
                                <td>0.29 m/min</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Block Contr√¥les Qualit√© -->
        <div class="sgq-block" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">üìä</span>
                    Contr√¥les Qualit√©
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <div>
                        <div>√âtat: CONFORME</div>
                        <div>Dernier contr√¥le: il y a 15 min</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Colonne Droite - 1/4 -->
    <div class="sgq-column sgq-column-right">
        <!-- Block En cours -->
        <div class="sgq-block sgq-block-success" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">üèÉ</span>
                    En cours
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <div style="text-align: center;">
                        <div style="font-size: 2rem; font-weight: bold;">84.3g/m</div>
                        <small>Rouleau #5</small>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Block Historique -->
        <div class="sgq-block" x-data="sgqBlock()">
            <div class="sgq-block-header" @click="toggle()" :class="{ 'collapsed': !isOpen }">
                <h3 class="sgq-block-title">
                    <span class="sgq-block-icon">üìà</span>
                    Historique
                </h3>
                <span class="sgq-block-arrow" :class="{ 'rotated': !isOpen }">‚ñº</span>
            </div>
            <div class="sgq-block-body" 
                 x-sgq-transitions>
                <div class="sgq-block-content">
                    <div>
                        <small>Graphique ici...</small>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}